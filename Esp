window.addEventListener('message', function(event) {
    if (event.data.type === "open") {
        document.body.style.display = "flex";
        updatePlayerList();
    }
});

function closeMenu() {
    document.body.style.display = "none";
    fetch(`https://${GetParentResourceName()}/close`, { method: 'POST' });
}

function sendAction(action) {
    const playerId = document.getElementById("playerList").value;
    fetch(`https://${GetParentResourceName()}/action`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ playerId, action })
    });
}

function updatePlayerList() {
    const select = document.getElementById("playerList");
    select.innerHTML = "";
    for (let i = 0; i < 128; i++) {
        const name = GetPlayerName(i);
        if (name) {
            const option = document.createElement("option");
            option.value = GetPlayerServerId(i);
            option.text = `${name} (${GetPlayerServerId(i)})`;
            select.appendChild(option);
        }
    }
}
